<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>macOS Password Manager</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <div class="login-card">
            <div class="login-header">
                            <img src="assets/icons/cbit.jpg" alt="CBIT Hyderabad" class="app-logo" width="64" height="64">
                            <div class="login-titles">
                    <h1>Password Manager</h1>
                    <p>Your macOS-inspired vault</p>
                </div>
            </div>
            <div class="user-switcher" aria-live="polite">
                <div class="avatar-frame">
                    <img src="assets/avatar-default.svg" alt="Default user avatar" class="user-avatar" width="128" height="128">
                </div>
                <div class="user-details">
                    <span class="user-name-display" id="login-username-display">Guest</span>
                    <span class="user-subtitle">Tap to change wallpaper &amp; user</span>
                </div>
            </div>
            <div class="login-wallpaper-tray" id="login-wallpaper-tray" aria-label="Quick wallpaper picker"></div>
            <form id="login-form" class="login-form" autocomplete="off">
                <label class="sr-only" for="username">Username</label>
                <div class="form-group floating">
                    <input type="text" id="username" required aria-label="Username">
                    <span class="floating-label">Username</span>
                </div>
                <label class="sr-only" for="password">Password</label>
                <div class="form-group floating">
                    <input type="password" id="password" required aria-label="Password">
                    <span class="floating-label">Password</span>
                </div>
                <div class="form-actions">
                    <button type="button" id="login-options-btn" class="btn btn-glass">Shut Down…</button>
                    <button type="submit" class="btn btn-primary">Log In</button>
                </div>
            </form>
            <div class="login-footer">
                <button type="button" id="register-btn" class="link-btn">Register New User</button>
                <div id="login-message" class="login-message" role="status" aria-live="polite"></div>
            </div>
        </div>
    </div>

    <!-- Desktop Environment -->
    <div id="desktop" class="desktop hidden">
        <!-- Menu Bar -->
        <div class="menu-bar" role="menubar">
            <div class="menu-left">
                <button class="menu-logo" id="apple-menu-btn" aria-haspopup="true" aria-expanded="false">
                                    <img src="assets/icons/cbit.jpg" alt="CBIT Menu" width="18" height="18">
                                </button>
                <div class="menu-app-name">Password Manager</div>
                <nav class="menu-items" aria-label="App menu">
                    <button class="menu-item" data-menu="app">App</button>
                    <button class="menu-item" data-menu="view">View</button>
                    <button class="menu-item" data-menu="window">Window</button>
                    <button class="menu-item" data-menu="help">Help</button>
                </nav>
            </div>
            <div class="menu-right">
                <div class="menu-status" id="desktop-status">Ready</div>
                <div class="menu-battery" aria-label="Battery status">
                    <span class="battery-icon" aria-hidden="true"></span>
                    <span class="battery-percent">100%</span>
                </div>
                <time id="current-time" aria-live="polite">10:00 PM</time>
                <button type="button" class="menu-user" id="switch-user-btn" title="Switch User">
                    <span id="current-user">Guest</span>
                </button>
            </div>
        </div>

        <div id="apple-menu" class="menu-dropdown hidden" role="menu" aria-labelledby="apple-menu-btn">
            <button class="menu-dropdown-item" data-action="about" role="menuitem">About This Mac</button>
            <div class="menu-separator"></div>
            <button class="menu-dropdown-item" data-action="sleep" role="menuitem">Sleep</button>
            <button class="menu-dropdown-item" data-action="restart" role="menuitem">Restart…</button>
            <button class="menu-dropdown-item" data-action="shutdown" role="menuitem">Shut Down…</button>
            <div class="menu-separator"></div>
            <button class="menu-dropdown-item" data-action="logout" role="menuitem">Log Out</button>
        </div>

        <!-- Desktop Background -->
        <div id="desktop-bg" class="desktop-bg"></div>

        <!-- Dock -->
        <div class="dock" role="toolbar" aria-label="macOS Dock">
            <div class="dock-reflection"></div>
            <div class="dock-spacer"></div>
            <button class="dock-icon" data-app="user-manager" title="User Manager" aria-label="User Manager">
                <img src="assets/icons/user-manager.svg" alt="User Manager" width="48" height="48">
            </button>
            <button class="dock-icon" data-app="terminal" title="Terminal" aria-label="Terminal">
                <img src="assets/icons/terminal.svg" alt="Terminal" width="48" height="48">
            </button>
            <button class="dock-icon" data-app="history-viewer" title="History Viewer" aria-label="History Viewer">
                <img src="assets/icons/history-viewer.svg" alt="History Viewer" width="48" height="48">
            </button>
            <button class="dock-icon" data-app="report-generator" title="Report Generator" aria-label="Report Generator">
                <img src="assets/icons/report-generator.svg" alt="Report Generator" width="48" height="48">
            </button>
            <button class="dock-icon" data-app="export-data" title="Export Data" aria-label="Export Data">
                <img src="assets/icons/export-data.svg" alt="Export Data" width="48" height="48">
            </button>
            <button class="dock-icon" data-app="advanced-settings" title="Advanced Settings" aria-label="Advanced Settings">
                <img src="assets/icons/advanced-settings.svg" alt="Advanced Settings" width="48" height="48">
            </button>
            <button class="dock-icon" data-app="wallpaper-settings" title="Wallpaper Settings" aria-label="Wallpaper Settings">
                <img src="assets/icons/wallpaper-settings.svg" alt="Wallpaper Settings" width="48" height="48">
            </button>
            <div class="dock-spacer"></div>
            <button class="dock-icon dock-trash" id="dock-trash" title="Trash" aria-label="Trash">
                <img src="assets/icons/trash.svg" alt="Trash" width="48" height="48">
            </button>
        </div>

        <!-- Windows Container -->
        <div id="windows-container" class="windows-container"></div>
    </div>

    <!-- Window Templates -->
    <template id="window-template">
        <div class="window" data-app="">
            <div class="window-header">
                <div class="traffic-lights">
                    <div class="traffic-light close" data-action="close"></div>
                    <div class="traffic-light minimize" data-action="minimize"></div>
                    <div class="traffic-light maximize" data-action="maximize"></div>
                </div>
                <div class="window-title">App Name</div>
            </div>
            <div class="window-content">
                <!-- App content will be inserted here -->
            </div>
        </div>
    </template>

    <!-- User Manager App Template -->
    <template id="user-manager-template">
        <div class="app-container">
            <div class="app-header">
                <h2>User Manager</h2>
                <button class="btn btn-primary" id="add-user-btn">Add User</button>
            </div>
            <div class="user-list">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Registered</th>
                            <th>Hash Preview</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body">
                        <!-- Users will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </template>

    <!-- Terminal App Template -->
    <template id="terminal-template">
        <div class="terminal-container">
            <div class="terminal-output" id="terminal-output">
                <div class="terminal-line">
                    <span class="terminal-prompt">macOS-pwdmgr:~ user$</span>
                    <span class="terminal-text">Welcome to Password Manager Terminal</span>
                </div>
                <div class="terminal-line">
                    <span class="terminal-prompt">macOS-pwdmgr:~ user$</span>
                    <span class="terminal-text">Type 'help' for available commands</span>
                </div>
            </div>
            <div class="terminal-input-container">
                <span class="terminal-prompt">macOS-pwdmgr:~ user$</span>
                <input type="text" class="terminal-input" id="terminal-input" autocomplete="off">
                <span class="terminal-cursor">█</span>
            </div>
        </div>
    </template>

    <!-- History Viewer App Template -->
    <template id="history-viewer-template">
        <div class="app-container">
            <div class="app-header">
                <h2>Login History</h2>
                <div class="filter-controls">
                    <select id="history-filter">
                        <option value="all">All Users</option>
                    </select>
                </div>
            </div>
            <div class="history-list">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Timestamp</th>
                            <th>Username</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="history-table-body">
                        <!-- History will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </template>

    <!-- Report Generator App Template -->
    <template id="report-generator-template">
        <div class="app-container">
            <div class="app-header">
                <h2>Report Generator</h2>
            </div>
            <div class="report-options">
                <button class="btn btn-primary" id="generate-users-report">Generate Users Report</button>
                <button class="btn btn-primary" id="generate-activity-report">Generate Activity Report</button>
                <button class="btn btn-primary" id="generate-security-report">Generate Security Report</button>
            </div>
            <div class="report-preview" id="report-preview">
                <h3>Report Preview</h3>
                <div class="report-content" id="report-content">
                    Select a report type to generate preview
                </div>
                <div class="report-actions hidden" id="report-actions">
                    <button class="btn btn-secondary" id="download-report">Download Report</button>
                </div>
            </div>
        </div>
    </template>

    <!-- Export Data App Template -->
    <template id="export-data-template">
        <div class="app-container">
            <div class="app-header">
                <h2>Export Data</h2>
            </div>
            <div class="export-options">
                <div class="export-option">
                    <h3>User Credentials</h3>
                    <p>Export usernames, salts, and hashed passwords as CSV</p>
                    <button class="btn btn-primary" id="export-users-csv">Export as CSV</button>
                </div>
                <div class="export-option">
                    <h3>Activity Logs</h3>
                    <p>Export login/logout history as CSV</p>
                    <button class="btn btn-primary" id="export-history-csv">Export as CSV</button>
                </div>
                <div class="export-option">
                    <h3>Full Database</h3>
                    <p>Export complete database as JSON</p>
                    <button class="btn btn-primary" id="export-full-json">Export as JSON</button>
                </div>
            </div>
            <div class="export-status" id="export-status"></div>
        </div>
    </template>

    <!-- Advanced Settings App Template -->
    <template id="advanced-settings-template">
        <div class="app-container">
            <div class="app-header">
                <h2>Advanced Settings</h2>
            </div>
            <div class="settings-list">
                <div class="setting-item">
                    <label for="min-password-length">Minimum Password Length:</label>
                    <input type="number" id="min-password-length" min="4" max="32" value="8">
                </div>
                <div class="setting-item">
                    <label for="session-timeout">Session Timeout (minutes):</label>
                    <input type="number" id="session-timeout" min="5" max="120" value="30">
                </div>
                <div class="setting-item">
                    <label class="switch">
                        <input type="checkbox" id="track-history" checked>
                        <span class="slider">Enable Login History Tracking</span>
                    </label>
                </div>
                <div class="setting-item danger-zone">
                    <h3>Danger Zone</h3>
                    <button class="btn btn-danger" id="clear-all-data">Clear All Data</button>
                </div>
            </div>
            <div class="settings-actions">
                <button class="btn btn-primary" id="save-settings">Save Settings</button>
            </div>
        </div>
    </template>

    <!-- Wallpaper Settings App Template -->
    <template id="wallpaper-settings-template">
        <div class="app-container wallpaper-settings">
            <div class="app-header">
                <h2>Wallpaper Settings</h2>
                <div class="wallpaper-header-actions">
                    <label class="toggle-control" id="dynamic-wallpaper-control">
                        <input type="checkbox" id="dynamic-wallpaper-toggle">
                        <span class="toggle-slider" aria-hidden="true"></span>
                        <span class="toggle-label">Dynamic Wallpaper</span>
                    </label>
                    <button class="btn btn-glass btn-sm" id="sync-wallpapers">Sync</button>
                </div>
            </div>
            <div class="wallpaper-grid" id="wallpaper-grid" role="list">
                <!-- Wallpapers will be populated here -->
            </div>
            <div class="wallpaper-custom">
                <div class="custom-upload">
                    <input type="file" id="custom-wallpaper-input" accept="image/*" hidden>
                    <label for="custom-wallpaper-input" class="btn btn-secondary btn-sm">Choose Custom Image…</label>
                    <span class="custom-file-name" id="custom-wallpaper-name">No image selected</span>
                </div>
                <button class="btn btn-primary btn-sm" id="apply-custom-wallpaper" disabled>Apply Custom Wallpaper</button>
            </div>
        </div>
    </template>

    <!-- Add User Modal -->
    <div id="add-user-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New User</h3>
                <button class="modal-close" id="close-add-user-modal" aria-label="Close">&times;</button>
            </div>
            <form id="add-user-form">
                <div class="form-group">
                    <label for="new-username">Username:</label>
                    <input type="text" id="new-username" required>
                </div>
                <div class="form-group">
                    <label for="new-password">Password:</label>
                    <input type="password" id="new-password" required>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Add User</button>
                    <button type="button" class="btn btn-secondary" id="cancel-add-user">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>